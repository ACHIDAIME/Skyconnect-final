{% extends 'core/base.html' %}
{% block title %}Accueil - SKYCONNECT{% endblock %}
{% block content %}
<style>
/* Fond animé avec particules */
#particles-js {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  z-index: 0;
  pointer-events: none;
}

/* Animation sur le titre principal */
@keyframes popTitle {
  0% { transform: scale(0.8); opacity: 0;}
  60% { transform: scale(1.1); opacity: 1;}
  100% { transform: scale(1); }
}
.hero-title {
  animation: popTitle 1.2s cubic-bezier(.4,0,.2,1) forwards;
  opacity: 0;
  animation-delay: 0.2s;
  text-shadow: 0 2px 16px var(--shadow-rouge-25), 0 0 32px var(--shadow-or-80);
}

/* Effet halo sur compteurs */
.counter {
  font-size: 2.2rem;
  font-weight: bold;
  color: var(--rouge-sky);
  text-shadow: 0 2px 8px var(--shadow-rouge-25), 0 0 16px var(--shadow-or-80);
  animation: halo 2s infinite alternate;
}
@keyframes halo {
  0% { text-shadow: 0 2px 8px var(--shadow-rouge-25), 0 0 8px var(--shadow-or-40);}
  100% { text-shadow: 0 2px 16px var(--shadow-rouge-25), 0 0 32px var(--shadow-or-80);}
}

/* Avantages effet rebond */
.advantage {
  transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
}
.advantage:hover {
  transform: scale(1.12) rotate(-2deg);
  box-shadow: 0 12px 32px var(--shadow-or-40), 0 8px 24px var(--shadow-rouge-12);
  background: var(--bg-gradient-mid);
  animation: bounce 0.5s;
}
@keyframes bounce {
  0% { transform: scale(1.12) rotate(-2deg);}
  50% { transform: scale(0.95) rotate(2deg);}
  100% { transform: scale(1.12) rotate(-2deg);}
}

/* Animation fade-in */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(40px);}
  to { opacity: 1; transform: none;}
}
.fade-in-up {
  opacity: 0;
  animation: fadeInUp 1s forwards;
}
.fade-in-up.delay-1 { animation-delay: 0.3s;}
.fade-in-up.delay-2 { animation-delay: 0.6s;}
.fade-in-up.delay-3 { animation-delay: 0.9s;}

/* Bouton "Voir nos offres" effet lumière */
.btn-animated {
  transition: transform 0.2s, box-shadow 0.2s;
  box-shadow: 0 2px 8px var(--shadow-or-80);
  background: linear-gradient(90deg,var(--or),var(--bg-gradient-mid));
  color: var(--rouge-fonce);
  font-weight: bold;
  position: relative;
  overflow: hidden;
}
.btn-animated::after {
  content: "";
  position: absolute;
  left: -40px; top: 0; width: 40px; height: 100%;
  background: var(--shine-white);
  transform: skewX(-20deg);
  transition: left 0.5s;
}
.btn-animated:hover::after {
  left: 100%;
}
.btn-animated:hover {
  transform: scale(1.12) rotate(-2deg);
  box-shadow: 0 4px 16px var(--shadow-or-80);
  background: linear-gradient(90deg,var(--bg-gradient-mid),var(--or));
  color: var(--rouge-vif);
}

/* Bouton flottant contact */
.fab-contact {
  position: fixed;
  bottom: 32px;
  right: 32px;
  z-index: 1001;
  background: linear-gradient(90deg,var(--rouge-sky-lighter),var(--rouge-sky));
  color: var(--blanc);
  border-radius: 50%;
  width: 56px; height: 56px;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 24px #d9042940;
  font-size: 2rem;
  animation: fabPop 1.2s 1.5s forwards;
  opacity: 0;
  transition: background 0.3s, transform 0.2s;
}
.fab-contact:hover {
  background: linear-gradient(90deg,var(--rouge-sky),var(--rouge-sky-lighter));
  transform: scale(1.15) rotate(-8deg);
}
@keyframes fabPop {
  from { opacity: 0; transform: scale(0.5);}
  to { opacity: 1; transform: scale(1);}
}

.hero-section {
  position: relative;
  overflow: hidden;
  background: linear-gradient(120deg,var(--rouge-cf) 0%,var(--gris-ultra-clair) 60%,var(--rouge-cf) 100%);
  box-shadow: 0 8px 32px var(--shadow-or-40);
  border-radius: 18px;
  animation: heroGlow 2.5s infinite alternate;
}
@keyframes heroGlow {
  0% { box-shadow: 0 8px 32px var(--shadow-or-40);}
  100% { box-shadow: 0 16px 64px var(--shadow-or-80);}
}

.btn-animated {
  position: relative;
  overflow: hidden;
  animation: btnPop 1.2s 1.5s cubic-bezier(.4,0,.2,1) forwards;
  opacity: 0;
}
@keyframes btnPop {
  from { opacity: 0; transform: scale(0.7);}
  to { opacity: 1; transform: scale(1);}
}
.btn-animated::after {
  content: "";
  position: absolute;
  left: -40px; top: 0; width: 40px; height: 100%;
  background: var(--shine-white);
  transform: skewX(-20deg);
  transition: left 0.5s;
}
.btn-animated:hover::after {
  left: 100%;
}
.btn-animated:hover {
  transform: scale(1.12) rotate(-2deg);
  box-shadow: 0 4px 16px var(--shadow-or-80);
  background: linear-gradient(90deg,var(--bg-gradient-mid),var(--or));
  color: var(--rouge-vif);
}
</style>
<script>
function openSouscriptionForm(forfaitId) {
  document.getElementById('forfaitIdInput').value = forfaitId;
  document.querySelector('#souscriptionModal form').action = '/souscription/' + forfaitId + '/';
  var modal = new bootstrap.Modal(document.getElementById('souscriptionModal'));
  modal.show();
}
</script>
<!-- filepath: c:\Users\mirab\Desktop\Stage\skyconnect-finalisation\core\templates\core\accueil.html -->
<div class="container my-5" style="background:var(--rouge-sky); border-radius:18px; box-shadow:0 2px 16px var(--shadow-rouge-25); padding-bottom:55px">  <div class="row g-4">
    {% if quick_blocks|length >= 4 %}
      {# Première image très large #}
      <div class="col-md-12">
        <div class="position-relative">
          <a href="{{ quick_blocks.0.get_url }}">
            <img src="{{ quick_blocks.0.image.url }}" alt="" class="w-100 rounded shadow" style="height:280px;object-fit:cover;border-radius:12px;">
          </a>
          {% if quick_blocks.0.extra_description %}
            <button type="button" class="btn btn-sm btn-warning position-absolute"
                    style="bottom:16px; right:16px; z-index:2;"
                    data-bs-toggle="collapse" data-bs-target="#extraDesc1">
              <i class="bi bi-info-circle"></i>
            </button>
            <div id="extraDesc1" class="collapse position-absolute"
                 style="bottom:56px; right:16px; z-index:3;">
              <div style="background:var(--overlay-noir-85); color:var(--blanc); border-radius:8px; padding:12px 18px; min-width:180px; max-width:320px; text-align:right; box-shadow:0 2px 12px var(--noir-222);">
                {{ quick_blocks.0.extra_description }}
              </div>
            </div>
          {% endif %}
        </div>
        <div style="height:12px;"></div>
          <p class="card-text" style="color:var(--blanc);">{{ quick_blocks.0.description }}</p>
        </div>
      </div>
      {# Bloc rectangle : 2e image à gauche, 3e et 4e empilées à droite #}
      <div class="row g-4 mb-2">
        <div class="col-md-6">
          <div class="position-relative h-100" style="height:400px;">
            <a href="{{ quick_blocks.1.get_url }}">
              <img src="{{ quick_blocks.1.image.url }}" alt="" class="w-100 rounded shadow h-100" style="object-fit:cover;border-radius:12px;">
            </a>
            {% if quick_blocks.1.extra_description %}
              <button type="button" class="btn btn-sm btn-warning position-absolute"
                      style="bottom:16px; right:16px; z-index:2;"
                      data-bs-toggle="collapse" data-bs-target="#extraDesc2">
                <i class="bi bi-info-circle"></i>
              </button>
              <div id="extraDesc2" class="collapse position-absolute"
                   style="bottom:56px; right:16px; z-index:3;">
                <div style="background:var(--overlay-noir-85); color:var(--blanc); border-radius:8px; padding:12px 18px; min-width:180px; max-width:320px; text-align:right; box-shadow:0 2px 12px var(--noir-222);">
                  {{ quick_blocks.1.extra_description }}
                </div>
              </div>
            {% endif %}
          </div>
          <div class="mt-2">
            <p class="card-text" style="color:var(--blanc);">{{ quick_blocks.1.description }}</p>
          </div>
        </div>
        <div class="col-md-6 d-flex flex-column justify-content-between">
          <div class="position-relative flex-fill" style="height:245px;">
            <a href="{{ quick_blocks.2.get_url }}">
              <img src="{{ quick_blocks.2.image.url }}" alt="" class="w-100 rounded shadow h-100" style="object-fit:cover;border-radius:12px;">
            </a>
            {% if quick_blocks.2.extra_description %}
              <button type="button" class="btn btn-sm btn-warning position-absolute"
                      style="bottom:16px; right:16px; z-index:2;"
                      data-bs-toggle="collapse" data-bs-target="#extraDesc3">
                <i class="bi bi-info-circle"></i>
              </button>
              <div id="extraDesc3" class="collapse position-absolute"
                   style="bottom:56px; right:16px; z-index:3;">
                <div style="background:var(--overlay-noir-85); color:var(--blanc); border-radius:8px; padding:12px 18px; min-width:180px; max-width:320px; text-align:right; box-shadow:0 2px 12px var(--noir-222);">
                  {{ quick_blocks.2.extra_description }}
                </div>
              </div>
            {% endif %}
          </div>
          <div class="mt-2">
            <p class="card-text" style="color:var(--blanc);">{{ quick_blocks.2.description }}</p>
          </div>
          <div class="position-relative flex-fill" style="height:50%;">
            <a href="{{ quick_blocks.3.get_url }}">
              <img src="{{ quick_blocks.3.image.url }}" alt="" class="w-100 rounded shadow h-100" style="object-fit:cover;border-radius:12px;">
            </a>
            {% if quick_blocks.3.extra_description %}
              <button type="button" class="btn btn-sm btn-warning position-absolute"
                      style="bottom:16px; right:16px; z-index:2;"
                      data-bs-toggle="collapse" data-bs-target="#extraDesc4">
                <i class="bi bi-info-circle"></i>
              </button>
              <div id="extraDesc4" class="collapse position-absolute"
                   style="bottom:56px; right:16px; z-index:3;">
                <div style="background:var(--overlay-noir-85); color:var(--blanc); border-radius:8px; padding:12px 18px; min-width:180px; max-width:320px; text-align:right; box-shadow:0 2px 12px var(--noir-222);">
                  {{ quick_blocks.3.extra_description }}
                </div>
              </div>
            {% endif %}
          </div>
          <div class="mt-2">
            <p class="card-text" style="color:var(--blanc);">{{ quick_blocks.3.description }}</p>
          </div>
        </div>
      </div>
      {# Les autres blocs classiques #}
      <div class="row g-4">
        {% for block in quick_blocks|slice:"4:" %}
          <div class="col-md-4">
            <div class="position-relative mb-4">
              <a href="{{ block.get_url }}">
                <img src="{{ block.image.url }}" alt="" class="w-100 rounded shadow" style="height:180px;object-fit:cover;">
              </a>
              {% if block.extra_description %}
                <button type="button" class="btn btn-sm btn-warning position-absolute"
                        style="bottom:16px; right:16px; z-index:2;"
                        data-bs-toggle="collapse" data-bs-target="#extraDesc{{ forloop.counter }}">
                  <i class="bi bi-info-circle"></i>
                </button>
                <div id="extraDesc{{ forloop.counter }}" class="collapse position-absolute"
                     style="bottom:56px; right:16px; z-index:3;">
                  <div style="background:var(--overlay-noir-85); color:var(--blanc); border-radius:8px; padding:12px 18px; min-width:180px; max-width:320px; text-align:right; box-shadow:0 2px 12px var(--noir-222);">
                    {{ block.extra_description }}
                  </div>
                </div>
              {% endif %}
            </div>
            <div class="mt-2">
              <p class="card-text" style="color:var(--blanc);">{{ block.description }}</p>
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>
<!-- Fond animé -->
<div id="particles-js"></div>

<!-- Compteurs animés -->
<section class="container my-5 fade-in-up delay-2" style="position:relative; z-index:1;">
  <div class="row text-center">
    <div class="col-md-4 mb-3">
      <a href="{% url 'zone_couverture' %}" style="text-decoration:none;">
        <div class="counter" data-target="1" style="color:var(--rouge-sky);">0</div>
        <div>
          <span style="color:var(--noir-222);font-weight:bold;">Couverture regionale</span>
          <span class="badge" style="background:var(--rouge-sky-lighter);color:var(--blanc);font-weight:bold;">Conakry</span>
        </div>
      </a>
    </div>
    <div class="col-md-4 mb-3">
      <a href="{% url 'qui_sommes_nous' %}" style="text-decoration:none;">
        <div style="height:2.2rem;">
          <i class="bi bi-people-fill" style="font-size:2.2rem;color:var(--rouge-sky);text-shadow:0 2px 8px var(--shadow-rouge-25);"></i>
        </div>
        <div>
          <span style="color:var(--noir-222);font-weight:bold;">Notre histoire & références</span>
          <span class="badge" style="background:var(--rouge-sky-lighter);color:var(--blanc);font-weight:bold;">Grands clients</span>
        </div>
      </a>
    </div>
    <div class="col-md-4 mb-3">
      <a href="{% url 'contact' %}" style="text-decoration:none;">
        <div class="counter" data-target="24" style="color:var(--rouge-sky);">0</div>
        <div>
          <span style="color:var(--noir-222);font-weight:bold;">Support 24h/24</span>
          <span class="badge" style="background:var(--rouge-sky-lighter);color:var(--blanc);font-weight:bold;">Contactez-nous</span>
        </div>
      </a>
    </div>
  </div>
</section>

<!-- Bons plans du moment -->
<section class="container my-5 fade-in-up delay-1" style="position:relative; z-index:1;">
  <h2 class="text-center mb-4" style="color:var(--rouge-sky);">Les bons plans du moment</h2>
  <div class="row g-4">
    {% for forfait in bons_plans_forfaits %}
      <div class="col-md-3 d-flex align-items-stretch">
        <div class="card border-danger shadow-sm h-100 card-offre">
          <div class="card-body d-flex flex-column justify-content-between text-start position-relative">
            <h5 class="card-title mb-2">
              {% if forfait.icone %}
                <i class="bi {{ forfait.icone }} me-2" style="color:var(--rouge-sky);"></i>
              {% endif %}
              {{ forfait.nom }}
            </h5>
            {% if forfait.image %}
              <a href="{% url 'forfaits' %}#forfait{{ forfait.id }}">
                <img src="{{ forfait.image.url }}" alt="{{ forfait.nom }}" class="img-fluid mb-2">
              </a>
            {% endif %}
            <ul class="mb-2">
              {% if forfait.description1 %}<li>{{ forfait.description1 }}</li>{% endif %}
              {% if forfait.description2 %}<li>{{ forfait.description2 }}</li>{% endif %}
              {% if forfait.description3 %}<li>{{ forfait.description3 }}</li>{% endif %}
              {% if forfait.description4 %}<li>{{ forfait.description4 }}</li>{% endif %}
            </ul>
            <div class="price-halo mb-2" style="color:var(--rouge-sky);">{{ forfait.prix|floatformat:0 }} GNF / mois</div>
            <button type="button" class="btn btn-animated mt-2 align-self-end" onclick="openSouscriptionForm({{ forfait.id }})">Souscrire</button>
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12 text-center">
        <p>Aucun forfait en promotion actuellement.</p>
      </div>
    {% endfor %}

    {% for produit in bons_plans_equipements %}
      <div class="col-md-3 d-flex align-items-stretch">
        <div class="card h-100 border-danger shadow-sm">
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ produit.nom }}</h5>
            {% if produit.image %}
              <a href="{% url 'produit_detail' produit.id %}">
                <img src="{{ produit.image.url }}" alt="{{ produit.nom }}" class="img-fluid mb-2">
              </a>
            {% endif %}
            {{ produit.description|truncatechars:60 }}
            <a href="{% url 'produit_detail' produit.id %}" class="btn btn-link p-0" style="color:var(--rouge-sky-lighter);">Voir plus</a>
            <div class="mt-auto price-halo" style="color:var(--rouge-sky);">{{ produit.prix_ttc|floatformat:0 }} GNF</div>
            {% if produit.quantite > 0 %}
              <button class="btn btn-animated mt-2" onclick="ajouterAuPanier({{ produit.id }})">Ajouter au panier</button>
            {% else %}
              <button class="btn btn-animated mt-2" disabled>Indisponible</button>
            {% endif %}
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12 text-center">
        <p>Aucun équipement en promotion actuellement.</p>
      </div>
    {% endfor %}
  </div>
</section>
<!-- filepath: c:\Users\mirab\Desktop\Stage\skyconnect-finalisation\core\templates\core\accueil.html -->
<section class="container my-5 fade-in-up delay-1" style="position:relative; z-index:1;">
  <h2 class="text-center mb-4" style="text-shadow:var(--shadow-rouge-text);">SKYactu</h2>
  <div class="row g-4">
    {% for actu in latest_news|slice:":3" %}
      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          {% if actu.images.first %}
            <img src="{{ actu.images.first.image.url }}" class="card-img-top" alt="{{ actu.titre }}" style="height:180px;object-fit:cover;">
          {% endif %}
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ actu.titre }}</h5>
            <p class="card-text">{{ actu.description|truncatechars:120 }}</p>
            <a href="{% url 'blog' %}#post{{ forloop.counter }}" class="btn btn-outline-secondary">En savoir plus</a>
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12 text-center">
        <p>Aucune actualité pour le moment.</p>
      </div>
    {% endfor %}
  </div>
  <div class="text-center mt-4">
    <a href="{% url 'blog' %}" class="btn btn-outline-secondary">Voir toutes les actualités</a>
  </div>
</section>
<!-- Avantages stylés -->
<section class="container my-5 fade-in-up delay-3" style="position:relative; z-index:1;">
    <h2 class="text-center mb-4" style="text-shadow:var(--shadow-rouge-text);">Pourquoi choisir SKYCONNECT ?</h2>
    <div class="row text-center">
        <div class="col-md-4 mb-4 advantage p-3 rounded shadow-sm">
            <i class="bi bi-lightning-charge" style="font-size:2.5rem;color:var(--rouge-sky);text-shadow:0 2px 8px var(--shadow-rouge-25);"></i>
            <h5 class="mt-2">Ultra rapide</h5>
            <p>Des débits élevés pour tous vos usages : streaming, télétravail, jeux en ligne…</p>
        </div>
        <div class="col-md-4 mb-4 advantage p-3 rounded shadow-sm">
            <i class="bi bi-shield-check" style="font-size:2.5rem;color:var(--rouge-sky);text-shadow:0 2px 8px var(--shadow-rouge-25);"></i>
            <h5 class="mt-2">Fiabilité & Réactivité</h5>
            <p>Un réseau moderne, sécurisé et une équipe disponible pour intervenir rapidement.</p>
        </div>
        <div class="col-md-4 mb-4 advantage p-3 rounded shadow-sm">
            <i class="bi bi-people" style="font-size:2.5rem;color:var(--rouge-sky);text-shadow:0 2px 8px var(--shadow-rouge-25);"></i>
            <h5 class="mt-2">Support client</h5>
            <p>Une équipe à votre écoute 7j/7 pour vous accompagner et vous dépanner.</p>
        </div>
    </div>
</section>

<!-- Nos services -->
<section class="container my-5 fade-in-up" style="position:relative; z-index:1;">
  <h2 class="text-center mb-4">Nos services</h2>
  <div class="row text-center">
    <div class="col-md-2 mb-3"><i class="bi bi-wifi" style="font-size:2rem;"></i><br>Internet à domicile</div>
    <div class="col-md-2 mb-3"><i class="bi bi-telephone" style="font-size:2rem;"></i><br>Câblage réseau informatique</div>
    <div class="col-md-2 mb-3"><i class="bi bi-tv" style="font-size:2rem;"></i><br>TV / Caméras de surveillance connectées</div>
    <div class="col-md-2 mb-3"><i class="bi bi-cloud-check" style="font-size:2rem;"></i><br>Solutions Cloud</div>
    <div class="col-md-2 mb-3"><i class="bi bi-headset" style="font-size:2rem;"></i><br>Support technique 24h/7</div>
    <div class="col-md-2 mb-3"><i class="bi bi-plus-circle" style="font-size:2rem;"></i><br>Autres services</div>
  </div>
</section>

<!-- Bouton flottant contact -->
<a href="{% url 'contact' %}" class="fab-contact" title="Contactez-nous">
  <i class="bi bi-chat-dots"></i>
</a>


<!-- Particules animées (nécessite particles.js) -->
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
<script>
particlesJS("particles-js", {
  "particles": {
    "number": { "value": 40, "density": { "enable": true, "value_area": 800 } },
    "color": { "value": "#ffd700" },
    "shape": { "type": "circle" },
    "opacity": { "value": 0.3, "random": true },
    "size": { "value": 6, "random": true },
    "line_linked": { "enable": false },
    "move": { "enable": true, "speed": 2, "direction": "none", "random": true, "straight": false, "out_mode": "out" }
  },
  "interactivity": {
    "detect_on": "canvas",
    "events": { "onhover": { "enable": true, "mode": "repulse" }, "onclick": { "enable": true, "mode": "push" } },
    "modes": { "repulse": { "distance": 80 }, "push": { "particles_nb": 4 } }
  },
  "retina_detect": true
});
</script>

<script>
// Animation fade-in au scroll
document.addEventListener("DOMContentLoaded", function() {
  const fadeEls = document.querySelectorAll('.fade-in-up');
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if(entry.isIntersecting) {
        entry.target.style.opacity = 1;
        entry.target.style.animationPlayState = 'running';
      }
    });
  }, { threshold: 0.2 });
  fadeEls.forEach(el => observer.observe(el));
  // Animation sur le titre
  document.querySelector('.hero-title').style.opacity = 1;
});

// Compteur animé
const counters = document.querySelectorAll('.counter');
counters.forEach(counter => {
  const updateCount = () => {
    const target = +counter.getAttribute('data-target');
    let count = +counter.innerText;
    const inc = Math.max(1, target / 100);
    if(count < target) {
      counter.innerText = Math.ceil(count + inc);
      setTimeout(updateCount, 20);
    } else {
      counter.innerText = target;
    }
  };
  updateCount();
});
</script>
<!-- Modal de souscription -->
<div class="modal fade" id="souscriptionModal" tabindex="-1" aria-labelledby="souscriptionModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <form method="post" action="/souscription/0/">
      {% csrf_token %}
      <input type="hidden" name="forfait_id" id="forfaitIdInput">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="souscriptionModalLabel">Souscription</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="region" class="form-label">Région</label>
             <select name="region" id="region" class="form-select" required>
              {% for region in regions %}
                <option value="{{ region.id }}">{{ region.region }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="mb-3">
            <label for="commune" class="form-label">Commune</label>
            <select name="commune" id="commune" class="form-select" required>
              {% for commune in communes %}
                <option value="{{ commune.id }}">{{ commune.nom }}</option>
              {% endfor %}
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-danger">Continuer</button>
        </div>
      </div>
    </form>
  </div>
</div>
<!-- Modal de confirmation -->
<div class="modal fade" id="panierModal" tabindex="-1" aria-labelledby="panierModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="panierModalLabel">Produit ajouté au panier</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <p>Voulez-vous continuer vers le panier ou poursuivre vos achats ?</p>
        <div class="d-flex justify-content-center gap-3">
          <a id="versPanierBtn" href="#" class="btn btn-outline-secondary">Aller au panier</a>
            <button type="button" class="btn" style="background:var(--rouge-sky-lighter); color:var(--blanc);" data-bs-dismiss="modal">Poursuivre les achats</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
function ajouterAuPanier(produitId) {
  fetch("{% url 'ajouter_au_panier' 0 %}".replace('0', produitId), {
    headers: {'X-Requested-With': 'XMLHttpRequest'}
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      // Met à jour le compteur du panier dans la navbar
      document.querySelectorAll('.panier-count').forEach(function(el) {
        el.textContent = data.panier_count;
      });
      // Affiche le modal
      document.getElementById('versPanierBtn').href = "{% url 'panier' %}";
      var modal = new bootstrap.Modal(document.getElementById('panierModal'));
      modal.show();
    }
  });
}
</script>
{% endblock %}
